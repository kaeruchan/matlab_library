clear all;
close all;
clc;
syms x;
a=1:10;

    x_k = [0.705398896919887533667e-01, ... 1
           0.372126818001611443794,     ... 2
           0.916582102483273564668, 	... 3
           0.170730653102834388069e01,  ... 4
           0.274919925530943212965e01,  ... 5
           0.404892531385088692237e01,  ... 6
           0.561517497086161651410e01,  ... 7
           0.745901745367106330977e01,  ... 8
           0.959439286958109677247e01,  ... 9
           0.120388025469643163096e02,  ... 10
           0.148142934426307399785e02,  ... 11
           0.179488955205193760174e02,  ... 12
           0.214787882402850109757e02,  ... 13
           0.254517027931869055035e02,  ... 14
           0.299325546317006120067e02,  ... 15
           0.350134342404790000063e02,  ... 16
           0.408330570567285710620e02,  ... 17
           0.476199940473465021399e02,  ... 18
           0.558107957500638988908e02,  ... 19
           0.665244165256157538186e02   ... 20
          ];

    w_k = [0.168746801851113862149,     ... 1
           0.291254362006068281717,     ... 2
           0.266686102867001288550,     ... 3
           0.166002453269506840031,	    ... 4
           0.748260646687923705401e-01, ... 5
           0.249644173092832210728e-01, ... 6
           0.620255084457223684745e-02, ... 7
           0.114496238647690824204e-02, ... 8
           0.155741773027811974780e-03, ... 9
           0.154014408652249156894e-04, ... 10
           0.108648636651798235148e-05, ... 11
           0.533012090955671475093e-07, ... 12
           0.175798117905058200358e-08, ... 13
           0.372550240251232087263e-10, ... 14
           0.476752925157819052449e-12, ... 15
           0.337284424336243841237e-14, ... 16
           0.115501433950039883096e-16, ... 17
           0.153952214058234355346e-19, ... 18
           0.528644272556915782880e-23, ... 19
           0.165645661249902329591e-27  ... 20
          ];
      cheb=zeros(1,length(a));
cheb1=zeros(1,length(a));
cheb2=zeros(1,length(a));
cheb3=zeros(1,length(a));
for aindex=1:length(a)
    %analysis
    cheb(aindex)= sum(chebfun(@(x) sin(a(aindex)*x^2)/x^2,[0, Inf]))
    
    %simulation
    
    for n=1:20
        cheb1(aindex) = cheb1(aindex)+sin(a(aindex)*x_k(n)^2)/x_k(n)^2*w_k(n)*exp(x_k(n));
    end
    cheb2(aindex) = sqrt(a(aindex)*pi/2);
    
    cheb3(aindex) = integral(@(x) sin(a(aindex).*x.^2)./x.^2,0,Inf)
end

% plot
p1=plot(a,cheb,'-');
ax = gca;
ax.FontSize=16;

xlabel('a','FontSize',16)
ylabel('f(x)','FontSize',16)

grid on
p1.Color='Black';
p1.LineWidth=2;
hold on
p2=plot(a,cheb1,'-.v');
p2.Color='Red';
p2.MarkerSize=10;
p2.LineWidth=2;

p3=plot(a,cheb2,'--+');
p3.Color='cyan';
p3.MarkerSize=10;
p3.LineWidth=2;

p4=plot(a,cheb3,'--o');
p4.Color='Blue';
p4.MarkerSize=10;
p4.LineWidth=2;


lgd=legend([p2,p3,p4], ...
    'Integrate by 20 points Gaussian-Laguerre', ...
    'Closed-form','Integrate by Matlab function');
lgd.FontSize=16;
lgd.Location='northwest';